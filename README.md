# CCTB

## 这是什么
是这样的，作者是一个被极域控制的xxs，受不了了，开始想办法关掉它  
我们学校有两种机房：win7机房和win10机房

### win7机房
据我所知，win7机房的极域没有保护（大概是2016的吧），使用`taskkill /f /im studentmain.exe`即可关闭

### win10机房
而win10机房有进程保护，应该是新版  
经测试，使用psexec将cmd提升至system权限再执行`taskkill /f /im studentmain.exe`也可以关闭  

而作者一般在win7机房上课  
听起来很好，对吧  

但是问题就来了，有sz同学也想要关，我还得手动去输入这些命令，太麻烦了  

**而且！**  
我们班有一群sz在玩‘主机保卫战’，按别人主机的电源按钮关其他人的主机  
还有会快捷键的，懂得使用`Alt + F4`关别人电脑

有需求就有市场，这款软件就诞生了

## 功能
1.关闭极域电子教室  
2.使用system权限关闭极域  
3.以system权限运行程序  
*3.1在程序内运行*  
*3.2在程序外运行*  
4.禁用关机  
5.启用关机  
6.解除所有限制  
7.退出  

## 作用及实现原理
1.后台执行`taskkill /f /im studentmain.exe`  
2.调用根目录下的psexec执行`psexec -s taskkill /f /im studentmain.exe`以使用system权限关闭极域  
3.调用psexec运行程序（区别就是有没有-i，对于gui程序，第一种不可用）（以后会改成只有第二种实现方式）  
4.通过修改注册表以禁用系统内的关机（作者是fvv，电源按钮的还是要手动禁用，以后应该会改吧）  
5.恢复上面进行的修改（其实是我debug用的）  
6.通过删除Policies达到解除储存在此的限制  
7.之前叫ai帮忙生成模板的时候生成的，留着做个纪念  

## 代码结构
第一次做这种项目，不会做项目结构啥的，只会硬堆在根目录，后面会改的吧。。。  
代码里有些已经成为了史山，0.3修了一点（写这个的时候0.3还没放到GitHub上）

## 注意！
该项目只能在Windows系统上运行（我寻思极域除了win还能有啥平台）  
自0.3版本开始，只有colorama版本，不想要颜色的可以自己删除  
要想程序在win7版本运行，编译为exe时请使用python3.7以前的版本  
作者也将尝试使用3.7编译程序（可能有bug）

## 立下的flag
1.在未来的某个版本将操作方式改为使用键盘↑↓键选择功能  
2.在未来的某个版本为程序添加gui界面  
3.实现上文中提到的东西  
4.整点看起来nb的东西

## 说点没用的
作者被奶酪客户端清空了iq，不会使用GitHub  
因此，0.2及以前的release只有源码  
而且作者认为需要一个单独的分支（区别是有没有使用colorama将文本变为彩色），后面删了，所以0.2以前的只剩下黑白命令行gui了  
好在本地还留着点源码，不至于lowiq配色瞎眼
